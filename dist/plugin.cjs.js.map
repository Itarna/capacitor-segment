{"version":3,"file":"plugin.cjs.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst SegmentAnalytics = registerPlugin('SegmentAnalytics', {\n    web: () => import('./web').then(m => new m.SegmentAnalyticsWeb()),\n});\nexport * from './definitions';\nexport { SegmentAnalytics };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nfunction buildSegmentScript(writeKey) {\n    return `!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error(\"Segment snippet included twice.\");else{analytics.invoked=!0;analytics.methods=[\"trackSubmit\",\"trackClick\",\"trackLink\",\"trackForm\",\"pageview\",\"identify\",\"reset\",\"group\",\"track\",\"ready\",\"alias\",\"debug\",\"page\",\"once\",\"off\",\"on\",\"addSourceMiddleware\",\"addIntegrationMiddleware\",\"setAnonymousId\",\"addDestinationMiddleware\"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement(\"script\");t.type=\"text/javascript\";t.async=!0;t.src=\"https://cdn.segment.com/analytics.js/v1/\" + key + \"/analytics.min.js\";var n=document.getElementsByTagName(\"script\")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey=\"9KLXaUrs09zme4ewqrSKzcVtHEiOtrAf\";;analytics.SNIPPET_VERSION=\"4.15.3\";\n  analytics.load(\"${writeKey}\");\n  analytics.page();\n  }}();`;\n}\nexport class SegmentAnalyticsWeb extends WebPlugin {\n    async initialize(args) {\n        const { writeKey } = args;\n        await this.loadScript('segment', buildSegmentScript(writeKey));\n    }\n    async identify(args) {\n        if (!window.analytics)\n            return Promise.reject('Segment is not initialized');\n        const { userId, traits, options } = args;\n        if (!userId)\n            return Promise.reject(\"User ID is required for 'identify' but not supplied\");\n        window.analytics.identify(userId, traits, options);\n    }\n    async track(args) {\n        if (!window.analytics)\n            return Promise.reject('Segment is not initialized');\n        const { eventName, properties, options } = args;\n        if (!eventName)\n            return Promise.reject('Event name is not supplied');\n        window.analytics.track(eventName, properties, options);\n    }\n    async screen(args) {\n        if (!window.analytics)\n            return Promise.reject('Segment is not initialized');\n        const { screenName, category, properties, options } = args;\n        if (!screenName)\n            return Promise.reject('Screen name must be supplied');\n        window.analytics.page(category, screenName, properties, options);\n    }\n    async page(args) {\n        if (!window.analytics)\n            return Promise.reject('Segment is not initialized');\n        const { pageName, category, properties, options } = args;\n        if (!pageName)\n            return Promise.reject('Page name must be supplied');\n        window.analytics.page(category, pageName, properties, options);\n    }\n    async group(args) {\n        if (!window.analytics)\n            return Promise.reject('Segment is not initialized');\n        const { userId, groupId, traits, options } = args;\n        if (!userId)\n            return Promise.reject('User ID was not supplied');\n        if (!groupId)\n            return Promise.reject('Group ID was not supplied');\n        window.analytics.group(userId, groupId, traits, options);\n    }\n    async alias(args) {\n        if (!window.analytics)\n            return Promise.reject('Segment is not initialized');\n        const { newId, options } = args;\n        if (!newId)\n            return Promise.reject('New ID was not supplied');\n        window.analytics.alias(newId, options);\n    }\n    async reset() {\n        if (!window.analytics)\n            return Promise.reject('Segment is not initialized');\n        window.analytics.flush();\n    }\n    /**\n     * Loaded single script with provided id and source\n     * @param id - unique identifier of the script\n     * @param src - source of the script\n     */\n    loadScript(id, script) {\n        return new Promise(resolve => {\n            if (document.getElementById(id)) {\n                resolve(null);\n            }\n            else {\n                const node = document.createTextNode(script);\n                const file = document.createElement('script');\n                file.type = 'text/javascript';\n                file.id = id;\n                file.onload = resolve;\n                file.onerror = console.error;\n                file.appendChild(node);\n                document.head.appendChild(file);\n            }\n        });\n    }\n}\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin"],"mappings":"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"}